build:
  gpu: true
  python_version: "3.10"
  # Specify the CUDA version explicitly so Cog knows which CUDA toolkit
  # to use. This fixes the error about unknown CUDA version for torch
  # in the GitHub Actions build logs.
  cuda: "12.1"
  # Install PyTorch early so that pip-installed packages depending on torch (e.g., tinycudann)
  # can build their wheels successfully during the build step. Without an explicit torch
  # installation, Cog's base GPU image may not provide it, leading to build failures.
  python_packages:
    - "torch==2.3.1"
    - "torchvision==0.18.1"
    - "torchaudio==2.3.1"
  system_packages:
    - "make"
    - "build-essential"
    - "libssl-dev"
    - "zlib1g-dev"
    - "libbz2-dev"
    - "libreadline-dev"
    - "libsqlite3-dev"
    - "wget"
    - "curl"
    - "llvm"
    - "libncurses5-dev"
    - "libncursesw5-dev"
    - "xz-utils"
    - "tk-dev"
    - "libffi-dev"
    - "liblzma-dev"
    - "git"
    - "ca-certificates"
    - "unzip"
    - "cmake"
    - "libgl1"
    - "libglib2.0-0"
    - "libjpeg-dev"
    - "libpng-dev"
    - "libboost-all-dev"
  run:
    - "chmod +x build.sh"
    - "./build.sh"

predict: "predict.py:Predictor"
