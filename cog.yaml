build:
  gpu: true
  cuda: "12.1"
  python_version: "3.10"
  system_packages:
    - wget
    - ca-certificates
    - git
    - unzip
    - cmake
    - build-essential
    - libgl1
    - libglib2.0-0
  run:
    - apt-get update -qq
    - apt-get install -qqy --no-install-recommends libjpeg-dev libpng-dev libboost-all-dev
    - echo "=== build root listing (normal) ==="
    - ls -al .
    - echo "=== build root listing (escaped) ==="
    - ls -lb .
    - echo "=== quoted filenames ==="
    - bash -lc 'for f in *; do printf "%q\n" "$f"; done'
    - echo "=== grep for requirement-ish names ==="
    - ls -al | grep -i req || true
    - test -f requirements.txt || (echo "ðŸ›‘ requirements.txt missing; above listing shows what is present" && exit 1)
    - mkdir -p Checkpoints/sam
    - wget -nc https://dl.fbaipublicfiles.com/segment_anything/sam_vit_h_4b8939.pth -P Checkpoints/sam/
    - git clone https://github.com/mkazhdan/PoissonRecon.git || true
    - make -C PoissonRecon
    - python -m pip install --upgrade pip
    - pip install -r requirements.txt cog
predict: "predict.py:Predictor"
